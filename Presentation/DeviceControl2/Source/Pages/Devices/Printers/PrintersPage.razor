@using DeviceControl2.Source.Features
@using DeviceControl2.Source.Widgets.Section
@using DeviceControl2.Source.Widgets.Section.DataGridActions
@using Ws.Domain.Models.Entities.Ref

@inherits SectionDataGridPageBase<PrinterEntity>
@attribute [Route($"{RouteUtils.SectionPrinters}{RouteUtils.SectionQrlQuery}")]
@rendermode InteractiveServer


<PageHeader>
  <span>Принтеры</span>
  <ItemsCounter ItemsCount="@SectionItems.Count()" IsLoading="IsLoading"/>
  <DataGridActionReload OnClick="@UpdateData" IsLoading="IsLoading" />
  <DataGridActionCreate OnClick="@OpenSectionCreateForm" />
</PageHeader>

<DataGridWrapper>
  <DataGridContainer
    TItem="PrinterEntity"
    Items="SectionItems"
    OnItemSelect="@(item => OpenDataGridEntityModal(item))"
    IsGroupable
  >
    <ColumnsContent>
      <DataGridColumn
        Caption="@Localizer["DataGridColumnName"]"
        Field="@nameof(PrinterEntity.Name)"
        Width="35%"
      />
      <DataGridColumn
        Caption="@Localizer["DataGridColumnType"]"
        Field="@nameof(PrinterEntity.Type)"
        Width="0%"
        Groupable
        Grouping
      />
      <DataGridColumn
        Caption="@Localizer["DataGridColumnIp"]"
        Field="@nameof(PrinterEntity.Ip)"
        Width="25%"
        Sortable="false"
      />
      <DataGridColumn
        Caption="@Localizer["DataGridColumnProductionSite"]"
        Field="ProductionSite.Name"
        Width="40%"
      />
    </ColumnsContent>
    <ContextMenuContent>
      <DataGridActionViewItem OnClick="@(() => ContextFuncWrapper(context.Item, context.CloseContextMenu, async item => await OpenDataGridEntityModal(item)))" />
      <DataGridActionOpenInNewTab OnClick="@(() => ContextFuncWrapper(context.Item, context.CloseContextMenu, async item => await OpenItemInNewTab(item)))" />
      <DataGridActionDeleteItem OnClick="@(() => ContextFuncWrapper(context.Item, context.CloseContextMenu, item => DeleteItem(item)))" />
    </ContextMenuContent>
  </DataGridContainer>
</DataGridWrapper>