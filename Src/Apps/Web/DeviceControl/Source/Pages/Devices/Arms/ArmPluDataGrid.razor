@using Blazor.Heroicons.Solid
@using DeviceControl.Source.Widgets.Section.DataGridActions
@using Ws.Domain.Models.Entities.Devices.Arms
@using Ws.Domain.Models.Entities.Ref1c.Plu
@using DeviceControl.Source.Widgets.Section
@inherits SectionDataGridPageBase<Ws.Domain.Models.Entities.Devices.Arms.ArmPlu>
@rendermode InteractiveServer

<PageHeader Class="!static">
  <span>@Localizer["SectionLinePLU"]</span>
  <DataGridItemsCounter ItemsCount="@SectionItems.Count()" IsLoading="IsLoading"/>
  <DataGridActionReload OnClick="@UpdateData" IsLoading="IsLoading" />
  @if (IsAllowToEdit)
  {
    <div class="w-96">
      <SelectMultiple
        TItem="Plu"
        Items="@SelectPluEntities"
        SelectedItems="@SelectedPluEntities"
        ItemDisplayName="item => item.DisplayName"
        IsFilterable
      />
    </div>
    <Button
      Size="ButtonSize.Icon"
      OnClick="@SaveSelectedPluEntities"
    >
      <CheckIcon class="size-5" />
    </Button>
    <Button
      Size="ButtonSize.Icon"
      Variant="ButtonVariant.Destructive"
      OnClick="@ResetSelectedPluEntities"
    >
      <ArrowUturnLeftIcon class="size-5" />
    </Button>
  }
</PageHeader>

<DataGridWrapper Class="bg-secondary/[.3] dark:bg-inherit">
  <DataGridContainer
    TItem="ArmPlu"
    Items="SectionItems"
    ItemsPerPage="6"
    IsForcePagination
  >
    <ColumnsContent>
      <DataGridColumn
        Caption="@WsDataLocalizer["ColNumber"]"
        Field="@($"{nameof(ArmPlu.Plu)}.{nameof(Plu.Number)}")"
        Width="10%"
      />
      <DataGridColumn
        Caption="@WsDataLocalizer["ColType"]"
        Field="@($"{nameof(ArmPlu.Plu)}.{nameof(Plu.IsCheckWeight)}")"
        Width="20%"
      >
        <DisplayTemplate>
          <span>
            @(context.Plu.IsCheckWeight ? WsDataLocalizer["ColPluWeight"] : WsDataLocalizer["ColPluPiece"])
          </span>
        </DisplayTemplate>
      </DataGridColumn>
      <DataGridColumn
        Caption="@WsDataLocalizer["ColName"]"
        Field="@($"{nameof(ArmPlu.Plu)}.{nameof(Plu.Name)}")"
        Width="70%"
      />
    </ColumnsContent>
    <ContextMenuContent>
      <DataGridActionOpenInNewTab OnClick="@(() => ContextFuncWrapper(context.Item, context.CloseContextMenu, item => OpenItemInNewTab(item)))" />
      <DataGridActionDeleteItem OnClick="@(() => ContextFuncWrapper(context.Item, context.CloseContextMenu, item => DeleteItem(item)))" />
    </ContextMenuContent>
  </DataGridContainer>
</DataGridWrapper>
