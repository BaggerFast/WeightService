@typeparam TValue
@inherits InputBase<TValue>

<input
  type="number"
  inputmode="numeric"
  id="@HtmlId"
  @attributes="AdditionalAttributes"
  @bind="Value"
  class="@Css.Class("flex h-10 w-full rounded-md border bg-background px-3 py-2 text-sm",
           "placeholder:text-muted-foreground focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50", Class)"
  disabled="@Disabled"
  readonly="@ReadOnly"
  autofocus="@AutoFocus"
  placeholder="@Placeholder"
  step="@Step"
  min="@Min"
  max="@Max"
/>

@code {
  [Parameter] public TValue? Min { get; set; }
  [Parameter] public TValue? Max { get; set; }
  [Parameter] public string Step { get; set; } = "1";

  private string InputValue
  {
    get => Value?.ToString() ?? string.Empty;
    set
    {
      if (!TryConvertValue(value, out TValue result)) return;
      Value = result;
      ValueChanged.InvokeAsync(Value);
    }
  }

  private bool TryConvertValue(string value, out TValue result)
  {
    try
    {
      result = (TValue)Convert.ChangeType(value, typeof(TValue));
      return true;
    }
    catch
    {
      result = default!;
      return false;
    }
  }
}
