@page "/item/plu_label"
@page "/item/plu_label/new"
@page "/item/plu_label/{IdentityUidStr}"
@attribute [Authorize(Roles = UserAccessStr.Read)]
@inherits RazorComponentItemBase<PluLabelModel>
@using DataCore.Sql.TableScaleModels.PlusLabels

<RazorItemReload TItem="@PluLabelModel" Title="@LocaleCore.DeviceControl.ItemLabel"/>

<MudSimpleTable Class="MudItemTable" Dense="true" Bordered="true" FixedHeader="false">
  <RazorItemTableHead CssTableStyleHead="@RzComponentUtils.GetTableHeadStyle(new() { 20, 30, 20, 30 })"/>
  <tbody>
    <RazorItemTableBody SqlItem="@SqlItemCast"/>
    <tr>
      <td>
       <RadzenLink Path="@GetRouteItemPath(LocaleCore.DeviceControl.RouteItemScale, SqlItemCast.PluScale.Scale)"
                                Text="@LocaleCore.Table.Scale"/>
      </td>
      <td>@SqlItemCast.PluScale.Scale.Description</td>
      <td>@LocaleCore.Table.CheckWeight</td>
      <td>
        <RadzenCheckBox TValue="bool" Disabled="true" Value="@IsWeighted"/>
      </td>
    </tr>
    <tr>
    <td>
      <RadzenLink Path="@GetRouteItemPath(LocaleCore.DeviceControl.RouteItemPlu, SqlItemCast.PluScale.Plu)"
                  Text="@LocaleCore.Table.Plu"/>
    </td>
    <td>@($"{SqlItemCast.PluScale.Plu.Number} | {SqlItemCast.PluScale.Plu.Name}")</td>
    <td>
      <RadzenLink Path="@GetRouteItemPath(LocaleCore.DeviceControl.RouteItemTemplate,
                          DataAccess.GetItemTemplateNotNullable(SqlItemCast.PluScale))"
                  Text="@LocaleCore.Table.Template"/>
    </td>
    <td>@DataAccess.GetItemTemplateNotNullable(SqlItemCast.PluScale).Title</td>
  </tr>
    @if (SqlItemCast.PluWeighing != null)
    {
      <tr>
        <td>
          <RadzenLink Path="@GetRouteItemPath(LocaleCore.DeviceControl.RouteItemPluWeighing, SqlItemCast.PluWeighing)"
                      Text="@LocaleCore.Table.Weighing"/>
        </td>
        <td>@SqlItemCast.PluWeighing.IdentityValueUid</td>

        <td />
        <td />
      </tr>
    }
    <tr>
      <td>@LocaleCore.Table.ProductDt</td>
      <td>@string.Format(StrUtils.FormatDtShort, SqlItemCast.ProductDt)</td>
      <td>@LocaleCore.Table.ExpirationDt</td>
      <td>@string.Format(StrUtils.FormatDtShort, SqlItemCast.ExpirationDt)</td>
    </tr>
    <tr>
      <td>
        <RadzenLink
          Path="@(LocaleCore.DeviceControl.LinkLabelary)"
          Text="@(LocaleCore.Table.TemplateLabelary)"/>
      </td>
      <td colspan="3">
        <RadzenTextArea
          Style="width: 100%; text-align: left; font-size: 10px; line-height: 16px; background-color: lightgray; "
          Disabled="false" ReadOnly="true"
          Value="@SqlItemCast.Zpl" Rows="20"/>
      </td>
    </tr>
    <AuthorizeView Roles="@UserAccessStr.Admin">
      <tr>
        <td>@LocaleCore.Table.Xml</td>
        <td colspan=3>
          @if (SqlItemCast.Xml is not null)
          {
            <RadzenTextArea
              Style="width: 100%; text-align: left; font-size: 10px; line-height: 16px; background-color: lightgray;"
              Disabled=false ReadOnly=true
              Value=@(DataFormatUtils.GetPrettyXmlOrJson(SqlItemCast.Xml.OuterXml)) Rows=20/>
          }
        </td>
      </tr>
    </AuthorizeView>
    <RazorItemDates SqlItem="@SqlItemCast"/>
  </tbody>
</MudSimpleTable>

<RazorItemActions
  TItem="@PluLabelModel"
  ButtonSettings="@ButtonSettings"
  OnItemSave="@SqlItemSaveAsync"
  OnItemCancel="@SqlItemCancelAsync"
  />
