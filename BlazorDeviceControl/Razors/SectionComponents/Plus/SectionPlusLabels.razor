@using DataCore.Sql.TableScaleModels.PlusLabels
@using BlazorDeviceControl.Razors.CustomComponents
@inherits RazorComponentSectionBase<DataCore.Sql.TableScaleModels.PlusLabels.PluLabelModel, SqlTableBase>
@page "/section/plus_labels"

<RazorSectionReload TItem="@PluLabelModel" TItemFilter="@SqlTableBase" ParentRazor="@(this)" Title="@LocaleCore.DeviceControl.SectionLabels" SqlCrudConfigSection="@SqlCrudConfigSection"/>

<RadzenDataGridLocal
  @bind-Value="@SelectedRow"
  TItem="@PluLabelModel"
  Data="@SqlSectionCast"
  CellContextMenu="@OnCellContextMenu"
  RowSelect="@(SqlItemSetAsync)"
  RowRender="@(args => RowRender(args))"
  RowDoubleClick="@(_ => SqlItemEditAsync())">
  <Columns>
    <TItemContent TItem="@PluLabelModel">
      <RazorSectionFieldIsMarked SqlCrudConfigSection="@SqlCrudConfigSection"/>
      <RadzenDataGridColumn TItem="@PluLabelModel" Width="12%" Title="@LocaleCore.Table.ChangeDt" TextAlign="@TextAlign.Center">
        <Template Context="itemCast">
          <RadzenLink Path=@($"{LocaleCore.DeviceControl.RouteItemPluLabel}/{itemCast.IdentityValueUid}")
                      Text="@(StringUtils.FormatDtRus(itemCast.ChangeDt, true, false))"/>
        </Template>
      </RadzenDataGridColumn>
      <RadzenDataGridColumn TItem="@PluLabelModel" Width="8%" Title="@LocaleCore.Table.ProductDt" TextAlign="@TextAlign.Center">
        <Template Context="itemCast">
          <RadzenLink Path=@($"{LocaleCore.DeviceControl.RouteItemPluLabel}/{itemCast.IdentityValueUid}")
                      Text="@(StringUtils.FormatDtRus(itemCast.ProductDt, false, false))"/>
        </Template>
      </RadzenDataGridColumn>
      <RadzenDataGridColumn TItem="@PluLabelModel" Width="8%" Title="@LocaleCore.Table.ExpirationDt" TextAlign="@TextAlign.Center">
        <Template Context="itemCast">
          <RadzenLink Path=@($"{LocaleCore.DeviceControl.RouteItemPluLabel}/{itemCast.IdentityValueUid}")
                      Text="@(StringUtils.FormatDtRus(itemCast.ExpirationDt, false, false))"/>
        </Template>
      </RadzenDataGridColumn>
      <RadzenDataGridColumn TItem="@PluLabelModel" Title="@LocaleCore.Table.Scale" Width="16%" TextAlign="@TextAlign.Left">
        <Template Context="itemCast">
          <RadzenLink Path=@($"{LocaleCore.DeviceControl.RouteItemPluLabel}/{itemCast.IdentityValueUid}")
                      Text="@(itemCast.PluScale.Scale.Description)"/>
        </Template>
      </RadzenDataGridColumn>
      <RadzenDataGridColumn TItem="@PluLabelModel" Title="@LocaleCore.Table.Plu" Width="23%" TextAlign="@TextAlign.Left">
        <Template Context="itemCast">
          <RadzenLink Path=@($"{LocaleCore.DeviceControl.RouteItemPluLabel}/{itemCast.IdentityValueUid}")
                      Text="@(itemCast.PluScale.Plu.Name)"/>
        </Template>
      </RadzenDataGridColumn>
      <RadzenDataGridColumn TItem="@PluLabelModel" Title="@LocaleCore.Table.Template" Width="16%" TextAlign="@TextAlign.Left">
        <Template Context="itemCast">
          <RadzenLink
            Path=@($"{LocaleCore.DeviceControl.RouteItemPluLabel}/{itemCast.IdentityValueUid}")
            Text="@(DataAccess.GetItemTemplateNotNullable(itemCast.PluScale).Title)"/>
        </Template>
      </RadzenDataGridColumn>
      <RadzenDataGridColumn TItem="@PluLabelModel" Title="@LocaleCore.Table.Weighing" Width="12%" TextAlign="@TextAlign.Center">
        <Template Context="itemCast">
          @if (itemCast.PluWeighing is not null)
          {
            <RadzenLink
              Path=@($"{LocaleCore.DeviceControl.RouteItemPluLabel}/{itemCast.IdentityValueUid}")
              Text=@(StringUtils.FormatDtRus(itemCast.PluWeighing.ChangeDt, true))/>
          }
        </Template>
      </RadzenDataGridColumn>
    </TItemContent>
  </Columns>
</RadzenDataGridLocal>
