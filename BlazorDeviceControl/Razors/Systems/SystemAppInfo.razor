@inherits BlazorCore.Models.RazorPageBase
@page "/system/appinfo"
@using static BlazorCore.Utils.BlazorCoreUtuls
@using BlazorCore.Razors
@using BlazorDeviceControl.Razors.Components
@using BlazorDeviceControl.Razors.Items.Components

<ItemReload T=TableBase ParentRazor=@(this) Title=@LocaleCore.System.SystemInfo />

<MudElement HtmlTag="h3" Class="ma-0">@LocaleCore.System.SystemInfo</MudElement>
<MudSimpleTable Style="overflow-x: auto; " Dense=true Bordered=true FixedHeader=false>
	<ItemTableHead T=TableBase ParentRazor=@(this) TableStyle=@ComponentsUtils.GetTabelHeadStyleInfo() />
    <tbody>
        <tr>
            <td>@LocaleCore.Strings.VerApp</td>
            <td colspan=2>
                @if (string.IsNullOrEmpty(VerApp))
                {
                    <ActionsLoad DataLoadItem=ActionLoadEnum.None IsShowProgress=true />
                }
                else
                {
                    <MudElement Class="ma-0">@VerApp</MudElement>
                }
            </td>
        </tr>
        <tr>
            <td>@LocaleCore.Strings.VerLibBlazorAndDataCore</td>
            <td>
                @if (string.IsNullOrEmpty(VerLibDataCore))
                {
                    <ActionsLoad DataLoadItem=ActionLoadEnum.None IsShowProgress=true />
                }
                else
                {
                    <MudElement Class="ma-0">@VerLibBlazorCore</MudElement>
                }
            </td>
            <td>
                @if (string.IsNullOrEmpty(VerLibDataCore))
                {
                    <ActionsLoad DataLoadItem=ActionLoadEnum.None IsShowProgress=true />
                }
                else
                {
                    <MudElement Class="ma-0">@VerLibDataCore</MudElement>
                }
            </td>
        </tr>
        <tr>
            <td>@LocaleCore.Strings.HostName</td>
            <td colspan=2>
                @if (string.IsNullOrEmpty(Environment.MachineName))
                {
                    <ActionsLoad DataLoadItem=ActionLoadEnum.None IsShowProgress=true />
                }
                else
                {
                    <MudElement Class="ma-0">@Environment.MachineName</MudElement>
                }
            </td>
        </tr>
        <tr>
            <td>@LocaleCore.Sql.SqlServer</td>
            <td colspan=2>
                @if (string.IsNullOrEmpty(AppSettings.DataAccess.JsonSettingsLocal.Sql.DataSource))
                {
                    <ActionsLoad DataLoadItem=ActionLoadEnum.None IsShowProgress=true />
                }
                else
                {
                    <MudElement Class="ma-0">@AppSettings.DataAccess.JsonSettingsLocal.Sql.DataSource</MudElement>
                }
            </td>
        </tr>
        <tr>
            <td>
                @LocaleCore.Sql.SqlDb
            </td>
            <td colspan=2>
                @if (string.IsNullOrEmpty(AppSettings.DataAccess.JsonSettingsLocal.Sql.InitialCatalog))
                {
                    <ActionsLoad DataLoadItem=ActionLoadEnum.None IsShowProgress=true />
                }
                else
                {
                    <MudElement Class="ma-0">@AppSettings.DataAccess.JsonSettingsLocal.Sql.InitialCatalog</MudElement>
                }
            </td>
        </tr>
        <tr>
            <td>
                @if (AppSettings.DataAccess.JsonSettingsLocal.Sql.PersistSecurityInfo == true)
                {
                    @LocaleCore.System.SystemWindowsUser
                }
                else
                {
                    @LocaleCore.Sql.SqlUser
                }
            </td>
            <td colspan=2>
                @if (string.IsNullOrEmpty(AppSettings.DataAccess.JsonSettingsLocal.Sql.UserId))
                {
                    <ActionsLoad DataLoadItem=ActionLoadEnum.None IsShowProgress=true />
                }
                else
                {
                    <MudElement Class="ma-0">@AppSettings.DataAccess.JsonSettingsLocal.Sql.UserId</MudElement>
                }
            </td>
        </tr>
        <tr>
            <td>@LocaleCore.Strings.DbAndMemory</td>
            <td >
                @if (DbCurSize == 0)
                {
                    <ActionsLoad DataLoadItem=ActionLoadEnum.None IsShowProgress=true />
                }
                else
                {
                    <MudElement Class="ma-0">@DbCurSizeAsString</MudElement>
                }
            </td>
            <td>
                <MudElement Class="ma-0">@AppSettings.MemoryInfo</MudElement>
            </td>
        </tr>
        <tr>
            <td>@LocaleCore.Strings.DbAndMemoryProgressBar</td>
            <td>
                @if (DbCurSize == 0)
                {
                    <ActionsLoad DataLoadItem=ActionLoadEnum.None IsShowProgress=true />
                }
                else
                {
                    <RadzenProgressBar class=@GetCssName.RadzenProgressBar Value=@DbFillSize ShowValue="true" />
                }
            </td>
            <td>
                <RadzenProgressBar class=@GetCssName.RadzenProgressBar Value=@AppSettings.MemoryFillSize ShowValue="true" />   
            </td>
        </tr>
        <tr style="height: 200px; ">
            <td>@LocaleCore.Strings.DbAndMemoryGauge</td>
            <td>
                @if (DbFillSize == 0)
                {
                    <ActionsLoad DataLoadItem=ActionLoadEnum.None IsShowProgress=true />
                }
                else
                {
                    <RadzenRadialGauge Style="width: 250px; height: 250px;">
	                    <RadzenRadialGaugeScale StartAngle="-150" EndAngle="150" Step=1024 Min=0 Max=@DbMaxSize 
	                        TickPosition=@GaugeTickPosition.Inside>
                            <RadzenRadialGaugeScalePointer Length=0.7 ShowValue=true Value=@DbCurSize>
                                <Template Context="pointer">
                                    <h4>@pointer.Value<sup>MB</sup></h4>
                                </Template>
                            </RadzenRadialGaugeScalePointer>
                            <RadzenRadialGaugeScaleRange From="0" To="75" Fill="green"/>
                            <RadzenRadialGaugeScaleRange From="75" To="90" Fill="orange"/>
                            <RadzenRadialGaugeScaleRange From="90" To="100" Fill="red"/>
                        </RadzenRadialGaugeScale>
                    </RadzenRadialGauge>
                }
            </td>
            <td>
                @if (AppSettings.Memory.MemorySize.PhysicalTotal is null)
                {
                    <ActionsLoad DataLoadItem=ActionLoadEnum.None IsShowProgress=true />
                }
                else
                {
                    <RadzenRadialGauge Style="width: 250px; height: 250px; ">
                        <RadzenRadialGaugeScale StartAngle="-150" EndAngle="150" Step=1024 Min=0
                            Max=@AppSettings.Memory.MemorySize.PhysicalTotal.MegaBytes
                            TickPosition=@GaugeTickPosition.Inside >
                            <RadzenRadialGaugeScalePointer Length=0.7 ShowValue=true
                                Value=@AppSettings.Memory.MemorySize.PhysicalAllocated.MegaBytes>
                                <Template Context="pointer">
                                    <h4>@pointer.Value<sup>MB</sup></h4>
                                </Template>
                            </RadzenRadialGaugeScalePointer>
                            <RadzenRadialGaugeScaleRange From="0" To="75" Fill="green" />
                            <RadzenRadialGaugeScaleRange From="75" To="90" Fill="orange" />
                            <RadzenRadialGaugeScaleRange From="90" To="100" Fill="red" />
                        </RadzenRadialGaugeScale>
                    </RadzenRadialGauge>
                }            </td>
        </tr>
        <tr>
            <td>@LocaleCore.Settings.SectionAndItemRowsCount</td>
            <td>
                <MudElement Class="ma-0">@AppSettings.DataAccess.JsonSettingsLocal.SectionRowsCount</MudElement>
            </td>
            <td>
                <MudElement Class="ma-0">@AppSettings.DataAccess.JsonSettingsLocal.ItemRowsCount</MudElement>
            </td>
        </tr>
        <tr>
            <td>@LocaleCore.Settings.SelectTopRowsCount</td>
            <td colspan=2>
                <MudElement Class="ma-0">@AppSettings.DataAccess.JsonSettingsLocal.SelectTopRowsCount</MudElement>
            </td>
        </tr>
        <tr>
            <td>@LocaleCore.Settings.Version</td>
            <td colspan=2>
                <MudElement Class="ma-0">@AppSettings.DataAccess.JsonSettingsLocal.Version</MudElement>
            </td>
        </tr>
        <tr>
            <td>@LocaleCore.Settings.AllowedHosts</td>
            <td colspan=2>
                <MudElement Class="ma-0">@AppSettings.DataAccess.JsonSettingsLocal.AllowedHosts</MudElement>
            </td>
        </tr>
    </tbody>
</MudSimpleTable>
<br />
