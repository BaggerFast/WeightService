@inherits BlazorCore.Models.RazorPageModel
@page "/system/identity"
@page "/system/identity/{IsShowReloadStr}"
@using BlazorDeviceControl.Razors.Systems
@using BlazorDeviceControl.Razors.Components
@using ActionsReloadItem = BlazorDeviceControl.Razors.Components.ActionsReloadItem

<AuthorizeView>
	<Authorizing>
		@if (UserSettings is not null)
		{
			RunActions(new() { () => UserSettings.SetupUserName(string.Empty, ParentRazor) }, !IsAuthorizingLoad);
			IsAuthorizingLoad = true;
		}
	</Authorizing>
	<Authorized>
		@if (UserSettings is not null)
		{
			RunActions(new() { () => UserSettings.SetupUserName(context.User.Identity?.Name, ParentRazor) }, !IsAuthorizingLoad);
			IsAuthorizingLoad = true;
		}
	</Authorized>
	<NotAuthorized>
		@if (UserSettings is not null)
		{
			RunActions(new() { () => UserSettings.SetupUserName(LocaleCore.System.SystemIdentityNotAuthorized, ParentRazor) }, !IsAuthorizingLoad);
			IsAuthorizingLoad = true;
		}
	</NotAuthorized>
</AuthorizeView>

@if (IsShowReload)
{
	<ActionsReloadItem ParentRazor=@(this) Title=@LocaleCore.System.SystemIdentityDataFull />
	
	<div>
		<RadzenLabel Style="margin-left: 0; margin-top: 2%; "
			Text=@(UserSettings is null ? LocaleCore.System.SystemIdentityNotAuthorized : UserSettings.UserDescription) />
		<br />
		<RadzenLabel Style="margin-left: 0; margin-top: 2%; " 
		    Text=@(UserSettings is null ? LocaleCore.System.SystemIdentityNotAuthorized : UserSettings.IdDescription) />
		<br />
		<RadzenLabel Style="margin-left: 0; margin-top: 2%; "
			Text=@(UserSettings is null ? LocaleCore.System.SystemIdentityNotAuthorized : UserSettings.IpAddressDescription) />
		<br />
	</div>
}
