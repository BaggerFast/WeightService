@inherits RazorComponentItemBase<TemplateModel>
@page "/item/template"
@page "/item/template/{IdentityId:long}"
@page "/item/template/{IdentityId:long}/{TableAction}"
@using BlazorCore.Razors

@if (!IsActionsParametersSetFinished)
{
    <RazorActionLoad ParentRazor=@(this) ActionLoad=ActionLoadEnum.Loading IsShowProgress=true />
}
else
{
	<RazorItemReload TItem=TemplateModel ParentRazor=@(this) Title=@LocaleCore.DeviceControl.ItemTemplate />

	<MudSimpleTable Style="overflow-x: auto;" Dense=true Bordered=true FixedHeader=false>
		<RazorItemTableHead TItem=TemplateModel ParentRazor=@(this) CssTableStyleHead=@RazorComponentUtils.GetTableHeadStyle(new() { 15, 35, 15, 35 }) />
		<tbody>
			<RazorItemTableBody TItem=TemplateModel ParentRazor=@(this) CssTableStyleBody=@RazorComponentUtils.GetTableBodyStyle(SqlFieldIdentityEnum.Id, true) />
			<tr>
				<td>@LocaleCore.Table.Title</td>
				<td>
					<RadzenTextBox Style="width: 100%; text-align: center;" @bind-Value=@SqlItemCast.Title/>
				</td>
				<td>
					<RadzenLabel Style="width: 100%; text-align: center;" Text=@LocaleCore.Table.CategoryName/>
				</td>
				<td>
					@if (TemplateCategories is null)
					{
						<RadzenTextBox Style="width: 100%;" ReadOnly=true Value=""/>
						<RadzenProgressBar Value=100 ShowValue="false" Mode="ProgressBarMode.Indeterminate" Style="width: 77%; height: 15px"/>
					}
					else
					{
						<RadzenDropDown Style="width: 100%;" TValue="string" FilterCaseSensitivity=FilterCaseSensitivity.CaseInsensitive
						                AllowFiltering=true AllowClear=true AllowFilteringByAllStringColumns=true
						                Data=@TemplateCategories PageSize=@AppSettings.DataAccess.JsonSettingsLocal.ItemRowsCount TextProperty="Name"
						                ValueProperty="Value" Value=@SqlItemCast.CategoryId
						                Change=@(args => OnChangeItem(SqlItemCast, nameof(SqlItemCast.CategoryId), args))/>
					}
				</td>
			</tr>
			<tr>
				<td>@LocaleCore.Table.ImageData</td>
				<td colspan=3>
					<RadzenTextArea Style="width: 100%; text-align: left; font-size: 11px; line-height: 20px;"
					                Disabled=false ReadOnly=false @bind-Value=@SqlItemCast.ImageData.ValueUnicode Rows=22/>
				</td>
			</tr>
		</tbody>
	</MudSimpleTable>

	<RazorItemActions TItem=TemplateModel ParentRazor=@(this) />
	<RazorItemDates TItem=TemplateModel ParentRazor=@(this) />
}
