@page "/item/scale"
@page "/item/scale/{Id:int}"
@using BlazorCore
@using BlazorCore.DAL.TableModels
@using BlazorCore.Utils
@using BlazorDeviceControl.Shared.Section
@inherits BlazorCore.Models.BaseRazorIdEntity
@inject IDialogService DialogService

@if (AppSettings.IdentityItem.AccessLevel is true or false)
{
    <MudElement HtmlTag="h3" Class="ma-0">
        @LocalizationStrings.DeviceControl.ItemScale
        <RadzenButton Click=@(args => SetParametersAsync(new ParameterView()))
                ButtonStyle="ButtonStyle.Primary"
                Style="margin-top: 3px; margin-left: 30px; width: 100px; height: 25px; font-size: 12px; "
                class="oi oi-reload"
                Disabled=@AppSettings.DataAccess.IsDisabled 
                MouseEnter="@(args => Tooltip.Open(args, LocalizationStrings.DeviceControl.TableReadData))" />
    </MudElement>
    @if (ScaleItem == null)
    {
        <DataLoad DataLoadItem=EnumDataLoad.Loading IsShowProgress=true />
    }
    else
    {
        <div class="col-sm-6 col-md-6 col-lg-6">
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldDescription />
            <RadzenTextBox Style="width: 50%; text-align: center;" Disabled="false" TValue="string" @bind-Value=@ScaleItem.Description />
            <br />
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldDeviceSendTimeout />
            <RadzenNumeric Style="width: 50%; text-align: center;" Disabled="false" TValue="short?" @bind-Value=@ScaleItem.DeviceSendTimeout />
            <br />
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldDeviceReceiveTimeout />
            <RadzenNumeric Style="width: 50%; text-align: center;" Disabled="false" TValue="short?" @bind-Value=@ScaleItem.DeviceReceiveTimeout />
            <br />
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldDeviceComPort />
            @if (ComPorts == null)
            {
                <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
            }
            else
            {
                <RadzenDropDown Style="width: 50%;" TValue="string" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                Data=@ComPorts PageSize="5" TextProperty="Name" ValueProperty="Value"
                                Value=@ScaleItem.DeviceComPort Change=@(args => OnChange(args, "DeviceComPort")) />
            }
            <br />
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldZebraPrinter />
            @if (PrinterItems == null)
            {
                <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
            }
            else
            {
                <RadzenDropDownDataGrid Style="width: 50%;" TValue="int" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                        AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                        Data=@PrinterItems PageSize="5"
                                        TextProperty="Name" ValueProperty="Id"
                                        Value=@ScaleItem.Printer?.Id
                                        Change=@(args => OnChange(args, "Printers")) />
            }
            <br />
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldHost />
            @if (HostItems == null)
            {
                <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
            }
            else
            {
                <RadzenDropDownDataGrid Style="width: 50%;" TValue="int" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                        AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                        Data=@HostItems PageSize="5"
                                        TextProperty="Name" ValueProperty="Id"
                                        Value=@ScaleItem.Host?.Id
                                        Change=@(args => OnChange(args, "Hosts"))>
                    <Columns>
                        <RadzenDropDownDataGridColumn Property="Name" Title=@LocalizationStrings.DeviceControl.TableFieldName Width="30%" />
                        <RadzenDropDownDataGridColumn Property="IdRRef" Title=@LocalizationStrings.DeviceControl.TableFieldIdRRef Width="70%" />
                    </Columns>
                </RadzenDropDownDataGrid>
            }
            <br />
        </div>
        <div class="col-sm-6 col-md-6 col-lg-6">
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldDeviceNumber />
            <RadzenNumeric Style="width: 50%; text-align: center;" Disabled="false" TValue="int?"
                            Name="fieldDeviceNumber" @bind-Value=@ScaleItem.DeviceNumber />
            <RadzenNumericRangeValidator Component="fieldDeviceNumber" Min="0"
                                            Text=@LocalizationStrings.Share.InputControlMuchZero Popup=true Style="position: absolute;" />
            <br />
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldUseOrder />
            <RadzenCheckBox Disabled="false" TValue="bool?" @bind-Value=@ScaleItem.UseOrder />
            <br />
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldTemplateDefault />
            @if (TemplatesDefaultItems == null)
            {
                <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
            }
            else
            {
                <RadzenDropDownDataGrid Style="width: 50%;" TValue="int" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                        AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                        Data=@TemplatesDefaultItems PageSize="5"
                                        TextProperty="Title" ValueProperty="Id"
                                        Value=@ScaleItem.TemplateDefault?.Id
                                        Change=@(args => OnChange(args, "TemplatesDefault")) />
            }
            <br />
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldTemplateSeries />
            @if (TemplatesSeriesItems == null)
            {
                <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
            }
            else
            {
                <RadzenDropDownDataGrid Style="width: 50%;" TValue="int" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                        AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                        Data=@TemplatesSeriesItems PageSize="5"
                                        TextProperty="Title" ValueProperty="Id"
                                        Value=@ScaleItem.TemplateSeries?.Id
                                        Change=@(args => OnChange(args, "TemplatesSeries")) />
            }
            <br />
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldWorkShopName />
            @if (WorkshopItems == null)
            {
                <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
            }
            else
            {
                <RadzenDropDownDataGrid Style="width: 50%;" TValue="int" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                        AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                        Data=@WorkshopItems PageSize="5"
                                        TextProperty="Name" ValueProperty="Id"
                                        Value=@ScaleItem.WorkShop?.Id
                                        Change=@(args => OnChange(args, "WorkShops")) />
            }
            <br />
            <RadzenLabel Style="width: 30%;" Text=@LocalizationStrings.DeviceControl.TableFieldScaleFactor />
            <RadzenNumeric Style="width: 50%; text-align: center;" Disabled="false" TValue="int?" @bind-Value=@ScaleItem.ScaleFactor />
            <br />
        </div>
        <Plus ScaleId=@Id />
        <EntitySave Item=@ScaleItem />
        <EntityDates Item=@ScaleItem />
    }
}
else
{
    <RadzenLabel Text=@LocalizationStrings.Share.SectionAccessDeny></RadzenLabel>
}
