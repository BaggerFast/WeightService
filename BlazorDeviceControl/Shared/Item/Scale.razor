@page "/item/scale"
@page "/item/scale/{Id:int}"
@using BlazorCore
@using BlazorCore.DAL.TableModels
@using BlazorCore.Utils
@using BlazorDeviceControl.Shared.Component
@using BlazorDeviceControl.Shared.Section
@inherits BlazorCore.Models.BaseRazorIdEntity
@inject IDialogService DialogService

@if (AppSettings.IdentityItem.AccessLevel is true or false)
{
    <DataReload Title=@LocalizationStrings.DeviceControl.ItemScale SetParameters=@SetParametersAsync />
    @if (Item == null)
    {
        <DataLoad DataLoadItem=EnumDataLoad.Loading IsShowProgress=true />
    }
    else
    {
        <MudSimpleTable Style="overflow-x: auto; " Dense=true Bordered=true FixedHeader=false>
            <thead>
                <tr>
                    <th Style="color:blue; font-weight:bold;">@LocalizationStrings.Share.RecordName</th>
                    <th Style="color:blue; font-weight:bold;">@LocalizationStrings.Share.RecordValue</th>
                    <th Style="color:blue; font-weight:bold;">@LocalizationStrings.Share.RecordName</th>
                    <th Style="color:blue; font-weight:bold;">@LocalizationStrings.Share.RecordValue</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>@LocalizationStrings.DeviceControl.TableFieldDescription</td>
                    <td>
                        <RadzenTextBox Style="width: 100%; text-align: center; " Disabled="false" 
                            TValue="string" @bind-Value=@ScaleItem.Description />
				    </td>
                    <td>@LocalizationStrings.DeviceControl.TableFieldDeviceSendTimeout</td>
                    <td>
                        <RadzenNumeric Style="width: 100%; text-align: center; " Disabled="false" 
                            TValue="short?" @bind-Value=@ScaleItem.DeviceSendTimeout />
				    </td>
                </tr>
                <tr>
                    <td>@LocalizationStrings.DeviceControl.TableFieldDeviceComPort</td>
                    <td>
                        @if (ComPorts == null)
                        {
                            <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
                        }
                        else
                        {
                            <RadzenDropDown Style="width: 100%;" TValue="string" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                Data=@ComPorts PageSize="5" TextProperty="Name" ValueProperty="Value"
                                Value=@ScaleItem.DeviceComPort Change=@(args => OnChange(args, "DeviceComPort")) />
                        }
				    </td>
                    <td>@LocalizationStrings.DeviceControl.TableFieldDeviceReceiveTimeout</td>
                    <td>
                        <RadzenNumeric Style="width: 100%; text-align: center;" 
                            Disabled="false" TValue="short?" @bind-Value=@ScaleItem.DeviceReceiveTimeout />
				    </td>
                </tr>
                <tr>
                    <td>@LocalizationStrings.DeviceControl.TableFieldPrinter</td>
                    <td>
                        @if (PrinterItems == null)
                        {
                            <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
                        }
                        else
                        {
                            <RadzenDropDownDataGrid Style="width: 100%;" TValue="int" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                Data=@PrinterItems PageSize="5"
                                TextProperty="Name" ValueProperty="Id"
                                Value=@ScaleItem.Printer?.Id
                                Change=@(args => OnChange(args, "Printers")) />
                        }
				    </td>
                    <td>@LocalizationStrings.DeviceControl.TableFieldHost</td>
                    <td>
                        @if (HostItems == null)
                        {
                            <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
                        }
                        else
                        {
                            <RadzenDropDownDataGrid Style="width: 100%;" TValue="int" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                Data=@HostItems PageSize="5"
                                TextProperty="Name" ValueProperty="Id"
                                Value=@ScaleItem.Host?.Id
                                Change=@(args => OnChange(args, "Hosts"))>
                                <Columns>
                                    <RadzenDropDownDataGridColumn Property="Name" Title=@LocalizationStrings.DeviceControl.TableFieldName Width="30%" />
                                    <RadzenDropDownDataGridColumn Property="IdRRef" Title=@LocalizationStrings.DeviceControl.TableFieldIdRRef Width="70%" />
                                </Columns>
                            </RadzenDropDownDataGrid>
                        }
				    </td>
                </tr>
                <tr>
                    <td>@LocalizationStrings.DeviceControl.TableFieldDeviceNumber</td>
                    <td>
                        <RadzenNumeric Style="width: 100%; text-align: center;" Disabled="false" 
                            TValue="int?" Name="fieldDeviceNumber" @bind-Value=@ScaleItem.DeviceNumber />
                        <RadzenNumericRangeValidator 
                            Component="fieldDeviceNumber" Min="0"
                            Text=@LocalizationStrings.Share.InputControlMuchZero Popup=true Style="position: absolute;" />
				    </td>
                    <td>@LocalizationStrings.DeviceControl.TableFieldUseOrder</td>
                    <td>
                        <RadzenCheckBox Disabled="false" TValue="bool?" @bind-Value=@ScaleItem.UseOrder />
				    </td>
                </tr>
                <tr>
                    <td>@LocalizationStrings.DeviceControl.TableFieldTemplateDefault</td>
                    <td>
                        @if (TemplatesDefaultItems == null)
                        {
                            <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
                        }
                        else
                        {
                            <RadzenDropDownDataGrid Style="width: 100%;" TValue="int" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                Data=@TemplatesDefaultItems PageSize="5"
                                TextProperty="Title" ValueProperty="Id"
                                Value=@ScaleItem.TemplateDefault?.Id
                                Change=@(args => OnChange(args, "TemplatesDefault")) />
                        }
				    </td>
                    <td>@LocalizationStrings.DeviceControl.TableFieldTemplateSeries</td>
                    <td>
                        @if (TemplatesSeriesItems == null)
                        {
                            <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
                        }
                        else
                        {
                            <RadzenDropDownDataGrid Style="width: 200%;" TValue="int" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                Data=@TemplatesSeriesItems PageSize="5"
                                TextProperty="Title" ValueProperty="Id"
                                Value=@ScaleItem.TemplateSeries?.Id
                                Change=@(args => OnChange(args, "TemplatesSeries")) />
                        }
				    </td>
                </tr>
                <tr>
                    <td>@LocalizationStrings.DeviceControl.TableFieldWorkShopName</td>
                    <td>
                        @if (WorkshopItems == null)
                        {
                            <DataLoad DataLoadItem=EnumDataLoad.None IsShowProgress=true />
                        }
                        else
                        {
                            <RadzenDropDownDataGrid Style="width: 100%;" TValue="int" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                AllowFiltering="true" AllowClear="true" AllowFilteringByAllStringColumns="true"
                                Data=@WorkshopItems PageSize="5"
                                TextProperty="Name" ValueProperty="Id"
                                Value=@ScaleItem.WorkShop?.Id
                                Change=@(args => OnChange(args, "WorkShops")) />
                        }
				    </td>
                    <td>@LocalizationStrings.DeviceControl.TableFieldScaleFactor</td>
                    <td>
                        <RadzenNumeric Style="width: 100%; text-align: center;" Disabled="false" 
                            TValue="int?" @bind-Value=@ScaleItem.ScaleFactor />
				    </td>
                </tr>
            </tbody>
        </MudSimpleTable>
        <Plus Table=@Table ScaleId=@Id />
        <ItemSave Table=@Table Id=@Id />
        <ItemDates Table=@Table Id=@Id />
    }
}
else
{
    <RadzenLabel Text=@LocalizationStrings.Share.SectionAccessDeny></RadzenLabel>
}
