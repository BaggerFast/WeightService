@inherits BlazorCore.Models.RazorBase
@page "/item/info"
@using BlazorCore
@using BlazorDeviceControl.Shared.Component
@using DataCore.Localizations
@using DataCore.Utils
@using static DataCore.ShareEnums

<ActionsReloadItem ParentRazor=@this 
    Title=@LocaleCore.System.SystemInfo SetParameters=@SetParametersAsync />
    
<MudElement HtmlTag="h3" Class="ma-0">@LocaleCore.Strings.AppSettings</MudElement>
<MudSimpleTable Style="overflow-x: auto; " Dense=true Bordered=true FixedHeader=false>
    <thead>
        <tr>
            <th Style="color:blue; font-weight:bold;">@LocaleCore.Strings.SettingName</th>
            <th Style="color:blue; font-weight:bold;">@LocaleCore.Strings.SettingValue</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>@LocaleCore.Strings.VerApp</td>
            @if (string.IsNullOrEmpty(VerApp))
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td><MudElement Class="ma-0">@VerApp</MudElement></td>
            }
        </tr>
        <tr>
            <td>@LocaleCore.Strings.VerLibBlazorCore</td>
            @if (string.IsNullOrEmpty(VerLibDataCore))
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td><MudElement Class="ma-0">@VerLibBlazorCore</MudElement></td>
            }
        </tr>
        <tr>
            <td>@LocaleCore.Strings.VerLibDataCore</td>
            @if (string.IsNullOrEmpty(VerLibDataCore))
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td><MudElement Class="ma-0">@VerLibDataCore</MudElement></td>
            }
        </tr>
        <tr>
            <td>@LocaleCore.Strings.HostName</td>
            @if (string.IsNullOrEmpty(Environment.MachineName))
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td><MudElement Class="ma-0">@Environment.MachineName</MudElement></td>
            }
        </tr>
        <tr>
            <td>@LocaleCore.Sql.SqlServer</td>
            @if (string.IsNullOrEmpty(AppSettings.DataAccess.JsonSettings?.Sql.Server))
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td><MudElement Class="ma-0">@AppSettings.DataAccess.JsonSettings?.Sql.Server</MudElement></td>
            }
        </tr>
        <tr>
            <td>@LocaleCore.Sql.SqlDb</td>
            @if (string.IsNullOrEmpty(AppSettings.DataAccess.JsonSettings?.Sql.Db))
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td><MudElement Class="ma-0">@AppSettings.DataAccess.JsonSettings.Sql.Db</MudElement></td>
            }
        </tr>
        <tr>
            @if (AppSettings.DataAccess.JsonSettings?.Sql.Trusted == true)
            {
                <td>@LocaleCore.System.SystemWindowsUser</td>
            }
            else
            {
                <td>@LocaleCore.Sql.SqlUser</td>
            }
            @if (string.IsNullOrEmpty(AppSettings.DataAccess.JsonSettings?.Sql.Username))
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td><MudElement Class="ma-0">@AppSettings.DataAccess.JsonSettings.Sql.Username</MudElement></td>
            }
        </tr>
        <tr>
            <td>@LocaleCore.Sql.SqlDbCurSize</td>
            @if (DbCurSize == 0)
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td><MudElement Class="ma-0">@DbCurSizeAsString</MudElement></td>
            }
        </tr>
        <tr>
            <td>@LocaleCore.Sql.SqlDbFillSize</td>
            @if (DbFillSize == 0)
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td>
                    <RadzenProgressBar 
                        Style="margin-top: 4px; margin-left: 0%; width: 90%; height: 22px; "
                        Value=@DbFillSize ShowValue="true" 
                    />
                </td>
            }
        </tr>
        <tr>
            <td>@LocaleCore.Memory.Memory</td>
            @if (AppSettings.Memory == null)
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td><MudElement Class="ma-0">@AppSettings.MemoryInfoShort</MudElement></td>
            }
        </tr>
        <tr>
            <td>@LocaleCore.Memory.MemoryFillSize</td>
            @if (AppSettings.Memory == null)
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td>
                    <RadzenProgressBar 
                        Style="margin-top: 4px; margin-left: 0%; width: 90%; height: 22px; "
                        Value=@AppSettings.MemoryFillSize ShowValue="true" 
                    />
                </td>
            }
        </tr>
    </tbody>
</MudSimpleTable>
<br />

<MudElement HtmlTag="h3" Class="ma-0">@LocaleCore.Strings.UserSettings</MudElement>
<MudSimpleTable Style="overflow-x: auto; " Dense=true Bordered=true FixedHeader=false>
    <thead>
        <tr>
            <th Style="color:blue; font-weight:bold;">@LocaleCore.Strings.SettingName</th>
            <th Style="color:blue; font-weight:bold;">@LocaleCore.Strings.SettingValue</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>@LocaleCore.Strings.AuthorizingUserName</td>
            @if (string.IsNullOrEmpty(UserSettings.Identity.Name))
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td><MudElement Class="ma-0">@UserSettings.Identity.Name</MudElement></td>
            }
        </tr>
        <tr>
            <td>@LocaleCore.Strings.AccessRights</td>
            <td><MudElement Class="ma-0">@BlazorCore.Models.IdentityEntity.GetDescriptionAccessRights(UserSettings.Identity.AccessRights)</MudElement></td>
        </tr>
        <tr>
            <td>@LocaleCore.Strings.Language</td>
            @if (TemplateLanguages == null || AppSettings.DataAccess.JsonSettings == null)
            {
                <td><ActionsLoad DataLoadItem=ShareEnums.ActionLoad.None IsShowProgress=true /></td>
            }
            else
            {
                <td>
                    <RadzenDropDown Style="width: 20%;" FilterCaseSensitivity=FilterCaseSensitivity.CaseInsensitive
                        Disabled=false TValue=@ShareEnums.Lang
                        AllowFiltering=false AllowClear=false AllowFilteringByAllStringColumns=false
                        Data=@TemplateLanguages PageSize=@AppSettings.DataAccess.JsonSettings.ItemRowCount TextProperty="Name" 
                        ValueProperty="Value" Value=@LocaleCore.Lang
                        Change=@(args => OnLocalizationValueChange(TemplateLanguages, args)) 
                    />
                </td>
            }
        </tr>
    </tbody>
</MudSimpleTable>
