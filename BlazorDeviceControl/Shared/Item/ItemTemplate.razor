@inherits BlazorCore.Models.RazorBase
@page "/item/template"
@page "/item/template/{IdentityId:long}"
@page "/item/template/{IdentityId:long}/{TableAction}"
@using DataCore.Localizations
@using BlazorCore.Shared
@using BlazorDeviceControl.Shared.Components
@using ActionsReloadItem = BlazorDeviceControl.Shared.Components.ActionsReloadItem
@using ActionsSave = BlazorDeviceControl.Shared.Components.ActionsSave
@using ItemDates = BlazorDeviceControl.Shared.Components.ItemDates
@using MudSimpleTableHead = BlazorDeviceControl.Shared.Components.MudSimpleTableHead

@if (!IsLoaded)
{
    <ActionsLoad ParentRazor=@this DataLoadItem=ShareEnums.ActionLoad.Loading IsShowProgress=true />
}
else
{
    <ActionsReloadItem ParentRazor=@this Title=@LocaleData.DeviceControl.Items.Template />

	<MudSimpleTable Style="overflow-x: auto;" Dense=true Bordered=true FixedHeader=false>
		<MudSimpleTableHead ParentRazor=@this TheadStyle=@ComponentsUtils.GetTheadStyle(new() { 15, 35, 15, 35 }) />
		<tbody>
		<tr>
			<td>@LocaleCore.Table.Id</td>
			<td>
				<RadzenNumeric Style="width: 100%; text-align: center; background-color: lightgray;"
				               Disabled=false ReadOnly=true
				               TValue="long" @bind-Value=@ItemCast.IdentityId/>
			</td>
			<td>@LocaleCore.Table.IsMarked</td>
			<td>
				<RadzenCheckBox Disabled=false TValue="bool" @bind-Value=@ItemCast.IsMarked/>
			</td>
		</tr>
		<tr>
			<td>@LocaleCore.Table.Title</td>
			<td>
				<RadzenTextBox Style="width: 100%; text-align: center;" Disabled=false
				               TValue="string" @bind-Value=@ItemCast.Title/>
			</td>
			<td>
				<RadzenLabel Style="width: 100%; text-align: center;" Text=@LocaleCore.Table.CategoryName/>
			</td>
			<td>
				@if (TemplateCategories == null)
				{
					<RadzenTextBox Style="width: 100%;" Disabled=false ReadOnly=true TValue="string" Value=""/>
					<RadzenProgressBar Value=100 ShowValue="false" Mode="ProgressBarMode.Indeterminate" Style="width: 77%; height: 15px"/>
				}
				else
				{
					<RadzenDropDown Style="width: 100%;" TValue="string" FilterCaseSensitivity=FilterCaseSensitivity.CaseInsensitive
					                AllowFiltering=true AllowClear=true AllowFilteringByAllStringColumns=true
					                Data=@TemplateCategories PageSize=@AppSettings.DataAccess.JsonSettingsLocal.ItemRowsCount TextProperty="Name"
					                ValueProperty="Value" Value=@ItemCast.CategoryId
					                Change=@(args => OnItemValueChange(ItemCast, nameof(ItemCast.CategoryId), args))/>
				}
			</td>
		</tr>
		<tr>
			<td>@LocaleCore.Table.ImageData</td>
			<td colspan=3>
				<RadzenTextArea Style="width: 100%; text-align: left; font-size: 11px; line-height: 20px;"
				                Disabled=false ReadOnly=false @bind-Value=@ItemCast.ImageData.ValueUnicode Rows=22/>
			</td>
		</tr>
		</tbody>
	</MudSimpleTable>
    
    <ActionsSave ParentRazor=@this ButtonSettings=@ButtonSettings />
    <ItemDates ParentRazor=@this />
}
