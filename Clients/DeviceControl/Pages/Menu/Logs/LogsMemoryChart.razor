@page "/section/logs_memory_chart"
@attribute [Authorize(Roles = WsUserAccessStr.Admin)]
@using DeviceControl.Utils
@using WsStorageCore.Tables.TableScaleModels.Apps
@inherits SectionBase<WsStorageCore.Views.ViewDiagModels.LogsMemory.WsSqlViewLogMemoryModel>

<RadzenCard class="w-100 mb-4" Style="display: flex; align-items: center; gap: 0.5rem">
    @* Приложение *@
    <RadzenLabel Text="@WsLocaleCore.DeviceControl.ItemApp" Style="margin-right: 1rem;" />
    <RadzenDropDown AllowClear="false" @bind-Value="@App" Data="@Apps"
                    TValue="WsSqlAppModel" TextProperty="DisplayName" />
    @* Устройство *@
    <RadzenLabel Text="@WsLocaleCore.DeviceControl.ItemDevice" Style="margin-right: 1rem;" />
    <RadzenDropDown AllowClear="false" @bind-Value="@Device" Data="@Devices"
                    TValue="WsSqlDeviceModel" TextProperty="DisplayName" />
    @* Интервал *@
    <RadzenLabel Text="@WsLocaleCore.DeviceControl.LogsMemoryTimeInterval" Style="margin-right: 1rem;" />
    <RadzenDropDown AllowClear="false" @bind-Value="@TimeInterval" Data="@TimeIntervals" />
</RadzenCard>

<RadzenCard class="w-100 mb-4" Style="display: flex; align-items: center; gap: 0.5rem">
    @* Тип чарта *@
    <RadzenLabel Text="@WsLocaleCore.DeviceControl.LogsMemoryChartType" Style="margin-right: 1rem;" />
    <RadzenDropDown AllowClear="false" @bind-Value="@WsInterpolation"
                    TValue="Interpolation" ValueProperty="Value" TextProperty="Text"
                    Data="@(Enum.GetValues<Interpolation>().Select(v => new { Value = v, Text = $"{v:G}" }))" />
    @* Цвет приложения *@
    <RadzenLabel Text="@WsLocaleCore.DeviceControl.LogsMemoryAppColor" Style="margin-right: 1rem;" />
    <RadzenDropDown AllowClear="false" @bind-Value="@MemoryAppColor" Data="@MemoryAppColors" />
    @* Цвет свободной памяти *@
    <RadzenLabel Text="@WsLocaleCore.DeviceControl.LogsMemoryFreeColor" Style="margin-right: 1rem;" />
    <RadzenDropDown AllowClear="false" @bind-Value="@MemoryFreeColor" Data="@MemoryFreeColors" />
</RadzenCard>

@* Чарт памяти приложения *@
<RadzenChart>
  <RadzenAreaSeries Interpolation="@WsInterpolation" Data="@SqlSectionCast" LineType="LineType.Solid" Fill="@MemoryAppColor"
                    Title="@WsLocaleCore.DeviceControl.MemoryChartApp" CategoryProperty="CreateDt" ValueProperty="SizeAppMb" />
  @*<RadzenValueAxis Formatter="@WsDataUtils.FormatCurrencyAsUsd">*@
  <RadzenValueAxis>
    @*<RadzenCategoryAxis Padding="20" Formatter="@WsDataUtils.FormatAsMonth" />*@
    <RadzenCategoryAxis Padding="20" />
    <RadzenGridLines Visible="true" />
    <RadzenAxisTitle Text="@WsLocaleCore.DeviceControl.MemoryChartLeft" />
  </RadzenValueAxis>
</RadzenChart>

@* Чарт свободной памяти *@
<RadzenChart>
  <RadzenLineSeries Interpolation="@WsInterpolation" Data="@SqlSectionCast" LineType="LineType.Dashed" Stroke="@MemoryFreeColor"
                    Title="@WsLocaleCore.DeviceControl.MemoryChartFree" CategoryProperty="CreateDt" ValueProperty="SizeFreeMb" />
  @*<RadzenValueAxis Formatter="@WsDataUtils.FormatCurrencyAsUsd">*@
  <RadzenValueAxis>
    @*<RadzenCategoryAxis Padding="20" Formatter="@WsDataUtils.FormatAsMonth" />*@
    <RadzenCategoryAxis Padding="20" />
    <RadzenGridLines Visible="true" />
    <RadzenAxisTitle Text="@WsLocaleCore.DeviceControl.MemoryChartLeft" />
  </RadzenValueAxis>
</RadzenChart>