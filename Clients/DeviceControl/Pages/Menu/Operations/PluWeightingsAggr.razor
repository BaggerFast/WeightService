@page "/section/plus_weightings_aggr"
@attribute [Authorize(Roles = UserAccessStr.Read)]
@using WsDataCore.Utils
@using DeviceControl.Components.Rz
@using WsStorageCore.ViewScaleModels.Aggregations
@inherits ComponentBase

<MudPaper Outlined="true" Class="mb-2">
  <MudToolBar Dense="true">
    <RadzenLabel Style="font-size: 15px;" Text="@WsLocaleCore.DeviceControl.SectionWeithingFactsAggregation"/>
    <RadzenCheckBox TValue="bool" @bind-Value="@IsShowPlu" Style="margin-left: 20px "/>
    <RadzenLabel Style="font-size: 13px; margin-left: 5px" Text="Учитывать плу"/>
    <RadzenButton
      Icon="refresh"
      ButtonStyle="@ButtonStyle.Primary"
      Style="margin-left: 20px; width: 60px;"
      Size="@ButtonSize.Small"
      Click="@GetSectionData"/>
    <RadzenLabel Style="margin-left: 20px; font-size: 13px; " Text="@SqlListCountResult"/>
  </MudToolBar>
</MudPaper>

<RzDataGrid
  TItem="@WsSqlViewWeightingAggrModel"
  Data="@PluWeightAggrs">
  <Columns>
    <TItemContent TItem="@WsSqlViewWeightingAggrModel">
      <RadzenDataGridColumn Title="@WsLocaleCore.Table.WeighDt" Property="ChangeDt" Width="15%"
                            FormatString="@WsStrUtils.FormatDtShort"/>
      <RadzenDataGridColumn TItem="@WsSqlViewWeightingAggrModel" Title="@WsLocaleCore.Table.DayOfWeek"
                            SortProperty="ChangeDt.DayOfWeek" Width="15%">
        <Template Context="itemCast">
          @WsEnumUtils.GetDayOfWeekRu(itemCast.ChangeDt.DayOfWeek)
        </Template>
      </RadzenDataGridColumn>
      <RadzenDataGridColumn Title="@WsLocaleCore.Table.Count" Property="Count" Width="15%"/>
      <RadzenDataGridColumn Title="@WsLocaleCore.Table.Line" Property="Line" Width="20%"/>
      <RadzenDataGridColumn Title="@WsLocaleCore.Table.PluNumber" Property="PluNumber" Width="10%" Visible="@IsShowPlu"/>
      <RadzenDataGridColumn Title="@WsLocaleCore.Table.Plu" Property="PluName" Width="30%" Visible="@IsShowPlu"/>
    </TItemContent>
  </Columns>
</RzDataGrid>